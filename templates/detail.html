<!doctype html>

<html>

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>欢迎来到个人技术博客 - 个人技术博客</title>
  <link href="/static/css/bootstrap.min.css" type="text/css" rel="stylesheet">
  <link href="/static/css/style.css" type="text/css" rel="stylesheet">
  <link href="/static/css/nprogress.css" type="text/css" rel="stylesheet">
  <!--[if lt IE 9]>
    <script src="/static/js/html5shiv.min.js" type="text/javascript"></script>
    <script src="/static/js/respond.min.js" type="text/javascript"></script>
    <script src="/static/js/selectivizr-min.js" type="text/javascript"></script>
<![endif]-->
  <link rel="apple-touch-icon-precomposed" href="/static/images/icon/icon.png">
  <link rel="shortcut icon" href="/static/images/icon/favicon.ico">
  <meta name="Keywords" content="" />
  <meta name="description" content="" />
  <script type="text/javascript">
    //判断浏览器是否支持HTML5
  </script>
  <style>
    .login_username {
      /* color: #fff; */
      /* font-size: 16px; */
      /* font-weight: bold; */
      text-align: center;
      background-color: greenyellow;
      width: 80%;
      /* padding: 10px; */
      margin: 10px auto;
      border-radius: 25%;
    }
    .login_btn1 {
      text-align: center;
      background-color: yellow;
      width: 50%;
      margin: 10px auto;
      border-radius: 50%;
    }
    li.login_btn2 {
      display: inline-block;
      text-align: center;
      background-color: yellow;
      width: 40%;
      margin: 10px auto;
      border-radius: 50%;
    }
    #login_btn2_on {
      text-align: center;
    }
  </style>
</head>

<body>
  <section class="container user-select">
    <header>
      <div class="hidden-xs header"><!--超小屏幕不显示-->
        <h1 class="logo"> <a href="index.html" title="个人技术博客"></a> </h1>
        <ul class="nav hidden-xs-nav">
          {% if request.session.username %}
          <li class="login_username">欢迎你，
            <strong>{{ request.session.username }}</strong>
          </li>
          <li class="login_btn1"><a href="/login/logout">退出</a></li>
          {% else %}
          <li class="login_username">欢迎你，
            <span>游客</span>
          </li>
          <li id="login_btn2_on">
            <ul>
              <li class="login_btn2"><a href="/login">登录</a></li>
              <li class="login_btn2"><a href="login/register">注册</a></li>
            </ul>
          </li>
          {% endif %}
          <li class="active"><a href="/"><span class="glyphicon glyphicon-home"></span>网站首页</a></li>
          <li><a href="/category/qian_duan"><span class="glyphicon glyphicon-erase"></span>网站前端</a></li>
          <li><a href="/category/hou_duan"><span class="glyphicon glyphicon-inbox"></span>后端技术</a></li>
          <li><a href="/admin"><span class="glyphicon glyphicon-globe"></span>管理系统</a></li>
          <li><a href="about.html"><span class="glyphicon glyphicon-user"></span>关于我们</a></li>
          <li><a href="friendly.html"><span class="glyphicon glyphicon-tags"></span>友情链接</a></li>
        </ul>
        <div class="feeds"> <a class="feed feed-xlweibo" href="" target="_blank"><i></i>新浪微博</a> <a
            class="feed feed-txweibo" href="" target="_blank"><i></i>腾讯微博</a> <a class="feed feed-rss" href=""
            target="_blank"><i></i>订阅本站</a> <a class="feed feed-weixin" data-toggle="popover" data-trigger="hover"
            title="微信扫一扫" data-html="true" data-content="<img src='/static/images/weixin.jpg' alt=''>" href="javascript:;"
            target="_blank"><i></i>关注微信</a> </div>
        <div class="wall"><a href="readerWall.html" target="_blank">读者墙</a> | <a href="tags.html"
            target="_blank">标签云</a></div>
      </div>
      <!--/超小屏幕不显示-->
      <div class="visible-xs header-xs"><!--超小屏幕可见-->
        <div class="navbar-header header-xs-logo">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#header-xs-menu"
            aria-expanded="false" aria-controls="navbar"><span
              class="glyphicon glyphicon-menu-hamburger"></span></button>
        </div>
        <div id="header-xs-menu" class="navbar-collapse collapse">
          <ul class="nav navbar-nav header-xs-nav">
            <li class="active"><a href="index.html"><span class="glyphicon glyphicon-home"></span>网站首页</a></li>
            <li><a href=""><span class="glyphicon glyphicon-erase"></span>网站前端</a></li>
            <li><a href=""><span class="glyphicon glyphicon-inbox"></span>后端技术</a></li>
            <li><a href=""><span class="glyphicon glyphicon-globe"></span>管理系统</a></li>
            <li><a href="about.html"><span class="glyphicon glyphicon-user"></span>关于我们</a></li>
            <li><a href="friendly.html"><span class="glyphicon glyphicon-tags"></span>友情链接</a></li>
          </ul>
          <form class="navbar-form" action="search.php" method="post" style="padding:0 25px;">
            <div class="input-group">
              <input type="text" class="form-control" placeholder="请输入关键字">
              <span class="input-group-btn">
                <button class="btn btn-default btn-search" type="submit">搜索</button>
              </span>
            </div>
          </form>
        </div>
      </div>
    </header>
    <!--/超小屏幕可见-->
    <div class="content-wrap"><!--内容-->
      <div class="content">
        <header class="news_header">
          <h2>{{ article.title }}</h2>
          <ul>
            <li>{{ article.author.username }} 发布于 {{ article.create_time|date:'Y-m-d' }}</li>
            {% comment %} TODO :分类，迭代 {% endcomment %}
            <li>栏目：<a href="" title="" target="_blank">{{ article.category_s_ }}</a></li>
            <li>来源：<a href="" title="" target="_blank">{{ article.source }}</a></li>
            <li>共 <strong>{{ article.look_num }}</strong> 人围观 </li>
            {% comment %} <li><strong>123</strong> 个不明物体</li> {% endcomment %}
          </ul>
        </header>
        <article class="news_content">
          {{ article.content|safe }}
        </article>
        <div class="reprint">转载请说明出处：<a href="" title="" target="_blank">个人技术博客</a> » <a href="" title=""
            target="_blank">欢迎来到个人技术博客</a>
        </div>

        {% comment %} 点赞 {% endcomment %}
        <div class="zambia">
          {% comment %} {% csrf_token %} {% endcomment %}
          <a href="javascript:;" name="zambia" rel="{{ article.id }}">
            <span class="glyphicon glyphicon-thumbs-up"></span> 赞（{{ article.like_num }}）
          </a>
        </div>
        <div class="tags news_tags">标签： 
          {% for tag in article.tags.all %}
            <span data-toggle="tooltip" data-placement="bottom" title="查看关于 {{ tag.name }} 的文章"><a
                href="">{{ tag.name }}</a>
            </span> 
          {% endfor %}
        </div>
        <nav class="page-nav"> 
          {% if previous_article %} 
            <span class="page-nav-prev">上一篇<br />
              <a href="../{{ previous_article.name_en }}/" rel="prev">{{ previous_article.title }}</a>
            </span> 
          {% endif %} 
          {% if next_article %} 
            <span class="page-nav-next">下一篇<br />
              <a href="../{{ next_article.name_en }}/" rel="next">{{ next_article.title }}</a>
            </span> 
          {% endif %}
        </nav>
        <div class="content-block related-content visible-lg visible-md">
          <h2 class="title"><strong>相关推荐</strong></h2>
          <ul>
            {% for article_related in article_related_all %}
              <li>
                <a target="_blank" href="../{{ article_related.name_en }}/"> 
                  <span class="thumb">
                    <img src="{{ article_related.thumb }}" alt="">
                  </span> 
                  <span
                    class="text"> {{ article_related.title|truncatechars:20 }} 
                  </span> 
                </a>
              </li>
            {% endfor %}
            {% comment %} <li><a target="_blank" href=""><img src="/static/images/logo.jpg" alt="">
                <h3> 欢迎来到个人技术博客,在这里可以看到网站前端和后端的技术等 </h3>
              </a></li>
            <li><a target="_blank" href=""><img src="/static/images/logo.jpg" alt="">
                <h3> 欢迎来到个人技术博客，在这里可以看到网站前端和后端的技术等 </h3>
              </a></li> {% endcomment %}
          </ul>
        </div>
        <div class="content-block comment">
          <h2 class="title"><strong>评论</strong></h2>
          {% comment %} 使用ajax时action="comment.php"没影响 {% endcomment %}
          <form action="comment.php" method="post" class="form-inline" id="comment-form">
            {% csrf_token %}
            {% comment %} 传递文章id {% endcomment %}
            <input type="hidden" name="commentId" class="form-control" id="commentId" value="{{ article.id }}">
            <div class="comment-title">
              <div class="form-group">
                <label for="commentName">昵称：</label>
                <input type="text" name="commentName" class="form-control" id="commentName" placeholder="技术博客">
              </div>
              <div class="form-group">
                <label for="commentEmail">邮箱：</label>
                <input type="email" name="commentEmail" class="form-control" id="commentEmail"
                  placeholder="admin@xxxx.com">
              </div>
            </div>
            <div class="comment-form">
              <textarea placeholder="你的评论可以一针见血" name="commentContent" id="commentContent"></textarea>
              <div class="comment-form-footer"></div>

              <div class="comment-form-btn">
                <div class="comment-form-btn">
                  {% comment %} 注意有type="submit"，要加上onclick="return false" {% endcomment %}
                  <button type="submit" class="btn btn-default btn-comment" onclick="return false">提交评论</button>
                </div>
              </div>
            </div>
          </form>
          <div class="comment-content">
            {% comment %} <ul>
              <li>
                <span class="face"><img src="/static/images/icon/icon.png" alt=""></span> 
                <span class="text">
                  <strong>技术博客站长</strong> (2015-10-18) 说：<br />
                  欢迎来到个人技术博客，在这里可以看到网站前端和后端的技术等在这里可以看到网站前端和后端的技术等在这里可以看到网站前端和后端的技术等 ...
                </span>
              </li>
              <li><span class="face"><img src="/static/images/icon/icon.png" alt=""></span> <span
                  class="text"><strong>技术博客编辑</strong> (2015-10-18) 说：<br />
                  欢迎来到个人技术博客，在这里可以看到网站前端和后端的技术等 ...</span></li>
              <li><span class="face"><img src="/static/images/icon/icon.png" alt=""></span> <span
                  class="text"><strong>令狐冲</strong> (2015-10-18) 说：<br />
                  欢迎来到个人技术博客，在这里可以看到网站前端和后端的技术等在这里可以看到网站前端和后端的技术等在这里可以看到网站前端和后端的技术等在这里可以看到网站前端和后端的技术等在这里可以看到网站前端和后端的技术等在这里可以看到网站前端和后端的技术等
                  ...</span></li>
              <li><span class="face"><img src="/static/images/icon/icon.png" alt=""></span> <span
                  class="text"><strong>任盈盈</strong> (2015-10-18) 说：<br />
                  欢迎来到个人技术博客，在这里可以看到网站前端和后端的技术等在这里可以看到网站前端和后端的技术等在这里可以看到网站前端和后端的技术等
                  ...欢迎来到个人技术博客，在这里可以看到网站前端和后端的技术等在这里可以看到网站前端和后端的技术等在这里可以看到网站前端和后端的技术等
                  ...欢迎来到个人技术博客，在这里可以看到网站前端和后端的技术等在这里可以看到网站前端和后端的技术等在这里可以看到网站前端和后端的技术等 ...</span></li>
              <li><span class="face"><img src="/static/images/icon/icon.png" alt=""></span> <span
                  class="text"><strong>技术博客站长</strong> (2015-10-18) 说：<br />
                  欢迎来到个人技术博客，在这里可以看到网站前端和后端的技术等 ...</span></li>
            </ul> {% endcomment %}
          </div>
        </div>
      </div>
    </div>
    <!--/内容-->
    <aside class="sidebar visible-lg"><!--右侧>992px显示-->
      {% comment %} 每日一句 {% endcomment %}
      <div class="sentence"> <strong>每日一句</strong>
        <!-- <h2>2015年11月1日 星期日</h2> -->
        <h2 id="TimeDiv" style="font-size: 16px;"></h2>
        <!-- <p>你是我人生中唯一的主角，我却只能是你故事中的一晃而过得路人甲。</p> -->
        <p>{{ sentence.content }}</p>
      </div>
      {% comment %} 搜素 {% endcomment %}
      <div id="search" class="sidebar-block search" role="search">
        <h2 class="title"><strong>搜索</strong></h2>
        <form class="navbar-form" action="search.php" method="post">
          <div class="input-group">
            <input type="text" class="form-control" size="35" placeholder="请输入关键字">
            <span class="input-group-btn">
              <button class="btn btn-default btn-search" type="submit">搜索</button>
            </span>
          </div>
        </form>
      </div>
      {% comment %} 热门推荐 {% endcomment %}
      <div class="sidebar-block recommend">
        <h2 class="title"><strong>热门推荐</strong></h2>
        <ul>
          {% for article_hot in article_hot_all %}
            <li>
              <a target="_blank" href="../{{ article_hot.name_en }}/"> 
                <span class="thumb">
                  <img src="{{ article_hot.thumb }}" alt="">
                </span> 
                <span
                  class="text"> {{ article_hot.title|truncatechars:20 }} 
                </span> 
                <span class="text-muted ">阅读({{ article_hot.look_num }})
                </span>
              </a>
            </li>
          {% endfor %}
        </ul>
      </div>
      {% comment %} 最新评论 {% endcomment %}
      <div class="sidebar-block comment">
        <h2 class="title"><strong>最新评论</strong></h2>
        <ul>
          {% for comment in latest_comment %}
            <li data-toggle="tooltip" data-placement="top" title="{{ comment.name }}的评论">
              <a target="_blank" href="">
                <span class="face"><img src="/static/images/icon/icon.png" alt=""></span> 
                <span class="text">
                  <strong>{{ comment.name }}</strong> ({{ comment.create_time }}) 说：<br />
                  {{ comment.content|truncatechars:30 }}
                </span>
              </a>
            </li>
          {% endfor %}
          {% comment %} <li data-toggle="tooltip" data-placement="top" title="站长的评论">
            <a target="_blank" href="">
              <span class="face"><img src="/static/images/icon/icon.png" alt=""></span> 
              <span class="text">
                <strong>技术博客站长</strong>
                (2015-10-18) 说：<br />
                欢迎来到个人技术博客，在这里可以看到网站前端和后端的技术等 ...
              </span>
            </a>
          </li>
          <li data-toggle="tooltip" data-placement="top" title="读者墙上的评论"><a target="_blank" href=""><span
                class="face"><img src="/static/images/icon/icon.png" alt=""></span> <span class="text"><strong>技术博客站长</strong>
                (2015-10-18) 说：<br />
                欢迎来到个人技术博客，在这里可以看到网站前端和后端的技术等 ...</span></a></li>
          <li data-toggle="tooltip" data-placement="top" title="个人技术博客的SHORTCUT和ICON图标...的评论"><a target="_blank"
              href=""><span class="face"><img src="/static/images/icon/icon.png" alt=""></span> <span
                class="text"><strong>技术博客站长</strong> (2015-10-18) 说：<br />
                欢迎来到个人技术博客，在这里可以看到网站前端和后端的技术等 ...</span></a></li>
          <li data-toggle="tooltip" data-placement="top" title="个人技术博客的SHORTCUT和ICON图标...的评论"><a target="_blank"
              href=""><span class="face"><img src="/static/images/icon/icon.png" alt=""></span> <span
                class="text"><strong>技术博客站长</strong> (2015-10-18) 说：<br />
                欢迎来到个人技术博客，在这里可以看到网站前端和后端的技术等 ...</span></a></li>
          <li data-toggle="tooltip" data-placement="top" title="个人技术博客的SHORTCUT和ICON图标...的评论"><a target="_blank"
              href=""><span class="face"><img src="/static/images/icon/icon.png" alt=""></span> <span
                class="text"><strong>技术博客站长</strong> (2015-10-18) 说：<br />
                欢迎来到个人技术博客，在这里可以看到网站前端和后端的技术等 ...</span></a></li> {% endcomment %}
        </ul>
      </div>
    </aside>

  </section>
  <div><a href="javascript:;" class="gotop" style="display:none;"></a></div>
  <!--/返回顶部-->
  <script src="/static/js/jquery-2.1.4.min.js" type="text/javascript"></script>
  <script src="/static/js/nprogress.js" type="text/javascript"></script>
  <script src="/static/js/bootstrap.min.js" type="text/javascript"></script>
  <script type="text/javascript">
    //页面加载
    $('body').show();
    $('.version').text(NProgress.version);
    NProgress.start();
    setTimeout(function () { NProgress.done(); $('.fade').removeClass('out'); }, 1000);
    //返回顶部按钮
    $(function () {
      $(window).scroll(function () {
        if ($(window).scrollTop() > 100) {
          $(".gotop").fadeIn();
        }
        else {
          $(".gotop").hide();
        }
      });
      $(".gotop").click(function () {
        $('html,body').animate({ 'scrollTop': 0 }, 500);
      });
    });
    //提示插件启用
    $(function () {
      $('[data-toggle="popover"]').popover();
    });
    $(function () {
      $('[data-toggle="tooltip"]').tooltip();
    });
    //鼠标滑过显示 滑离隐藏
    //banner
    $(function () {
      $(".carousel").hover(function () {
        $(this).find(".carousel-control").show();
      }, function () {
        $(this).find(".carousel-control").hide();
      });
    });
    //本周热门
    $(function () {
      $(".hot-content ul li").hover(function () {
        $(this).find("h3").show();
      }, function () {
        $(this).find("h3").hide();
      });
    });
    //新增
    //相关推荐
    $(function () {
      $(".related-content ul li").hover(function () {
        $(this).find("h3").show();
      }, function () {
        $(this).find("h3").hide();
      });
    });
    //页面元素智能定位
    $.fn.smartFloat = function () {
      var position = function (element) {
        var top = element.position().top; //当前元素对象element距离浏览器上边缘的距离 
        var pos = element.css("position"); //当前元素距离页面document顶部的距离
        $(window).scroll(function () { //侦听滚动时 
          var scrolls = $(this).scrollTop();
          if (scrolls > top) { //如果滚动到页面超出了当前元素element的相对页面顶部的高度 
            if (window.XMLHttpRequest) { //如果不是ie6 
              element.css({ //设置css 
                position: "fixed", //固定定位,即不再跟随滚动 
                top: 0 //距离页面顶部为0 
              }).addClass("shadow"); //加上阴影样式.shadow 
            } else { //如果是ie6 
              element.css({
                top: scrolls  //与页面顶部距离 
              });
            }
          } else {
            element.css({ //如果当前元素element未滚动到浏览器上边缘，则使用默认样式 
              position: pos,
              top: top
            }).removeClass("shadow");//移除阴影样式.shadow 
          }
        });
      };
      return $(this).each(function () {
        position($(this));
      });
    };
    //启用页面元素智能定位
    $(function () {
      $("#search").smartFloat();
    });


    //ajax更新点赞值 和 评论
    $(function () {
      // 更新点赞值
      $(".content .zambia a").click(function () {
        var zambia = $(this);
        var id = zambia.attr("rel"); //对应id   
        // console.log(id);
        // zambia.fadeOut(1000); //渐隐效果   
        // var csrftoken = jQuery("[name=csrfmiddlewaretoken]").val();
        $.ajax({
          type: "POST",
          // url: "zambia.php",
          url: "/zan/",
          // data: "id=" + id,
          data: {"id": id}, // 传递多个参数时一般这么写
          // beforeSend: function(xhr) {
          //   xhr.setRequestHeader("X-CSRFToken", csrftoken);
          // },
          cache: false, //不缓存此页面   
          success: function (res) {
            console.log(res);
            if(res.redirect) {
              window.location.href = res.redirect;
            }
            if (res.status == 200) {
              var htm = `<span class="glyphicon glyphicon-thumbs-up"></span> 赞（${res.data}）`;
              zambia.html(htm);
              // zambia.html(res.data);
              // zambia.html('<span class="glyphicon glyphicon-thumbs-up"></span> 赞（' + res.data + '）');
            }else{
              alert(res.msg);
            }
            // zambia.html(res.data); 
            // zambia.fadeIn(1000); //渐显效果   
          }
        });
        return false;
      });

      // 定义更新评论函数-
      function update_comment(data) {
        $.post("/detail_comment/", data, function (res) {
          console.log(res);
          var h_total = ``;
          res.data.forEach(function (item, index) {
            h_total += `
              <li>
                <span class="face"><img src="/static/images/icon/icon.png" alt=""></span> 
                <span class="text">
                  <strong>${item.name}</strong> (${item.create_time}) 说：<br />
                  ${item.content}
                </span>
              </li> 
            `; 
          });
          var htm = `
            <ul>
              ${h_total}
            </ul>
          `;
          $(".comment-content").html(htm);
        });
      }
      // 发送评论
      $(".btn-comment").click(function () {
        var commentId = $("#commentId").val();
        var commentName = $("#commentName").val();
        var commentEmail = $("#commentEmail").val();
        var commentContent = $("#commentContent").val();
        // var commentContent = $("textarea[name='commentContent']").val();
        // var csrfmiddlewaretoken = $("input[name='csrfmiddlewaretoken']").val();
        var csrfmiddlewaretoken = "{{ csrf_token }}";
        console.log(commentId, commentName, commentEmail, commentContent);
        if (commentName == "") {
          alert("昵称不能为空");
          return false; //阻止表单提交
        }
        if (commentEmail == "") {
          alert("邮箱不能为空");
          return false; //阻止表单提交
        }
        if (commentContent == "") {
          alert("评论内容不能为空");
          return false; //阻止表单提交
        }
        {% comment %} $.ajax({
          type: "POST",
          url: "/comment/",
          data: {
            "commentId": commentId,
            "commentName": commentName,
            "commentEmail": commentEmail,
            "commentContent": commentContent
          },
          // es6可以简写
          // data: {commentId, commentName, commentEmail, commentContent},
          cache: false, //不缓存此页面
          success: function (res) {
            console.log(res);
            if (res.status == 200) {
              alert(res.msg);
            }else{
              alert(res.msg);
            }
          }
        }); {% endcomment %}
        // 普通写法(非ajax)
        var data = { commentId, commentName, commentEmail, commentContent, csrfmiddlewaretoken };
        update_comment(data)
        {% comment %} $.post("/detail_comment/", data, function (res) {
          console.log(res);
          var h_total = ``
          res.data.forEach(function (item, index) {
            h_total += `
              <li>
                <span class="face"><img src="/static/images/icon/icon.png" alt=""></span> 
                <span class="text">
                  <strong>${item.name}</strong> (${item.create_time}) 说：<br />
                  ${item.content}
                </span>
              </li> 
            `;             
          });
          var htm = `
            <ul>
              ${h_total}
            </ul>
          `;
          $(".comment-content").html(htm);
        }); {% endcomment %}
        return false;
      });
      // 更新评论
      update_comment({ "commentId": $("#commentId").val(), "csrfmiddlewaretoken": "{{ csrf_token }}" });
    })
  </script>
  <!-- //每日一句 -->
  <script type="text/javascript">
  
    window.onload = function () {
      function getDate() {
        var date = new Date();
        var year = date.getFullYear();
        var month = date.getMonth() + 1;
        var day = date.getDate();
        var week = date.getDay();
        var weeks = ["日", "一", "二", "三", "四", "五", "六"];
        var hour = date.getHours();
        var minute = date.getMinutes();
        var second = date.getSeconds();
        // var time = year + "年" + month + "月" + day + "日" + " 星期" + weeks[week] + " " + hour + ":" + minute + ":" + second;
        var time = year + "年" + month + "月" + day + "日" + " 星期" + weeks[week] + " " + hour.toString().padStart(2, 0) + ":" + minute + ":" + second;
        document.getElementById("TimeDiv").innerHTML = time;
      }
      getDate();
      setInterval(getDate, 1000); //每隔1秒运行一次
    }
  </script>
</body>

</html>