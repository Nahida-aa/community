(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5814],{37063:function(e,t,n){Promise.resolve().then(n.bind(n,60026)),Promise.resolve().then(n.bind(n,16631)),Promise.resolve().then(n.bind(n,32025)),Promise.resolve().then(n.bind(n,68518)),Promise.resolve().then(n.bind(n,68849)),Promise.resolve().then(n.bind(n,33277)),Promise.resolve().then(n.bind(n,31463)),Promise.resolve().then(n.bind(n,41614)),Promise.resolve().then(n.bind(n,57550)),Promise.resolve().then(n.bind(n,28919)),Promise.resolve().then(n.bind(n,62741)),Promise.resolve().then(n.bind(n,83534)),Promise.resolve().then(n.bind(n,97976)),Promise.resolve().then(n.bind(n,98823)),Promise.resolve().then(n.bind(n,60497)),Promise.resolve().then(n.bind(n,52519)),Promise.resolve().then(n.bind(n,11344)),Promise.resolve().then(n.bind(n,91267)),Promise.resolve().then(n.t.bind(n,86579,19)),Promise.resolve().then(n.t.bind(n,42540,19)),Promise.resolve().then(n.t.bind(n,56611,23)),Promise.resolve().then(n.t.bind(n,64590,23)),Promise.resolve().then(n.t.bind(n,32574,23)),Promise.resolve().then(n.bind(n,73786)),Promise.resolve().then(n.bind(n,56735)),Promise.resolve().then(n.bind(n,9607)),Promise.resolve().then(n.bind(n,15660)),Promise.resolve().then(n.bind(n,85910)),Promise.resolve().then(n.bind(n,74352)),Promise.resolve().then(n.bind(n,39534)),Promise.resolve().then(n.bind(n,91519)),Promise.resolve().then(n.bind(n,93980)),Promise.resolve().then(n.bind(n,96271)),Promise.resolve().then(n.bind(n,70334)),Promise.resolve().then(n.bind(n,18310)),Promise.resolve().then(n.t.bind(n,31310,23)),Promise.resolve().then(n.bind(n,54401)),Promise.resolve().then(n.bind(n,85569)),Promise.resolve().then(n.bind(n,32293)),Promise.resolve().then(n.bind(n,97317)),Promise.resolve().then(n.bind(n,48457)),Promise.resolve().then(n.bind(n,66736)),Promise.resolve().then(n.bind(n,47794)),Promise.resolve().then(n.bind(n,77210)),Promise.resolve().then(n.bind(n,89243)),Promise.resolve().then(n.bind(n,33082)),Promise.resolve().then(n.bind(n,55235)),Promise.resolve().then(n.bind(n,30465)),Promise.resolve().then(n.bind(n,56196)),Promise.resolve().then(n.bind(n,86765)),Promise.resolve().then(n.bind(n,60228)),Promise.resolve().then(n.bind(n,66579)),Promise.resolve().then(n.bind(n,61962)),Promise.resolve().then(n.bind(n,13205)),Promise.resolve().then(n.bind(n,13569)),Promise.resolve().then(n.bind(n,82633)),Promise.resolve().then(n.bind(n,83404))},56735:function(e,t,n){"use strict";n.r(t),n.d(t,{Analyze:function(){return l}});var r=n(71590),i=n(63488),s=n(97270);let l=()=>{let e=(0,i.useRef)(!1);return(0,s.useServerInsertedHTML)(()=>{if(!e.current)return e.current=!0,(0,r.jsx)("script",{dangerouslySetInnerHTML:{__html:"(".concat((function(){document.addEventListener("click",async e=>{let t=e.target,n=t,r=t.dataset.event;for(;!r&&n&&n!==document.body;)r=n.dataset.event,n=n.parentElement;if(r){var i;console.info("dom track click event",r),null===(i=window.umami)||void 0===i||i.track(r,{type:"click"})}},!0),document.addEventListener("impression",async e=>{var t;let n=e.detail;console.info(n,"detail"),null===(t=window.umami)||void 0===t||t.track(n.label,{type:"impression"})})}).toString(),")();")}})}),null}},15660:function(e,t,n){"use strict";n.r(t),n.d(t,{ErrorBoundary:function(){return o}});var r=n(71590),i=n(68396),s=n(58704);let l=()=>(0,r.jsxs)("div",{className:"flex w-full flex-col py-6 center",children:["Something went wrong. Please contract to"," ",(0,r.jsx)("a",{href:"mailto:i@innei.in",className:"shiro-link--underline",children:"i@innei.in"}),".",(0,r.jsx)(s.Sn,{onClick:()=>{window.location.reload()},children:"Reload Page"})]}),o=e=>{let{children:t}=e;return(0,r.jsx)(i.SV,{FallbackComponent:l,onError:e=>{console.error(e)},children:t})}},85910:function(e,t,n){"use strict";n.r(t),n.d(t,{Global:function(){return l}});var r=n(63488),i=n(17664),s=n(8585);let l=()=>((0,s.L)(()=>{Object.assign(window,{React:r,ReactDOM:i,react:r,reactDom:i})},[]),null)},52810:function(e,t,n){"use strict";n.d(t,{X:function(){return a}});var r=n(71590),i=n(63488),s=n(7038),l=n(62719),o=n(35987);let a=e=>{let{shouldTrack:t=!0,...n}=e;return t?(0,r.jsx)(c,{...n}):(0,r.jsx)(r.Fragment,{children:e.children})},c=(0,i.memo)(e=>{let[t,n]=(0,i.useState)(!1),a=(0,l.DH)(),{ref:c}=(0,s.YD)({initialInView:!1,triggerOnce:!0,onChange(t){if(t){var r,i;n(!0),a||(document.dispatchEvent(new CustomEvent("impression",{detail:{action:null!==(i=e.action)&&void 0!==i?i:o.b.Impression,label:e.trackerMessage}})),null===(r=e.onTrack)||void 0===r||r.call(e))}}});return(0,r.jsxs)(r.Fragment,{children:[e.children,!t&&(0,r.jsx)("span",{ref:c})]})});c.displayName="ImpressionView"},39534:function(e,t,n){"use strict";n.r(t),n.d(t,{ScrollTop:function(){return o}});var r=n(63488),i=n(97270),s=n(76877),l=n(48213);let o=(0,r.memo)(()=>{let e=(0,i.usePathname)();return(0,r.useEffect)(()=>{s.r8||(0,l.YG)()},[e]),null});o.displayName="ScrollTop"},2226:function(e,t,n){"use strict";n.d(t,{V:function(){return i}});var r=n(71590);function i(e){return(0,r.jsx)("svg",{width:"1em",height:"1em",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e,children:(0,r.jsx)("path",{d:"M11 15H7C4.79086 15 3 16.7909 3 19C3 20.1046 3.89543 21 5 21H15M16.8744 13C16.2164 13.4935 15.6221 14.066 15.1049 14.7043C15.035 14.7906 15 14.8953 15 15M16.8744 17C16.2164 16.5065 15.6221 15.934 15.1049 15.2957C15.035 15.2094 15 15.1047 15 15M15 15H21M15 7C15 9.20914 13.2091 11 11 11C8.79086 11 7 9.20914 7 7C7 4.79086 8.79086 3 11 3C13.2091 3 15 4.79086 15 7Z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}},91519:function(e,t,n){"use strict";n.r(t),n.d(t,{GatewayInfo:function(){return b}});var r=n(71590),i=n(98823),s=n(17765),l=n(22003),o=n(62719),a=n(52810),c=n(86940),u=n(74723),d=n(18278),m=n(46403),h=n(35987),p=n(57317),x=n(29494),f=n(10826);let v=()=>(0,r.jsx)(d.r,{as:"span",triggerElement:(0,r.jsx)("i",{className:"icon-[mingcute--question-line] cursor-help"}),type:"tooltip",asChild:!0,children:(0,r.jsxs)("div",{className:"space-y-2 leading-relaxed",children:[(0,r.jsxs)("p",{className:"flex items-center space-x-1 opacity-80",children:[(0,r.jsx)("i",{className:"icon-[mingcute--question-line]"}),(0,r.jsx)("span",{className:"font-medium",children:"这是如何实现的？"})]}),(0,r.jsx)("p",{children:"当你打开这个页面时，会自动建立 WebSocket 连接，当成功连接后服务器会推送当前浏览页面的人数。"}),(0,r.jsx)("p",{children:"WebSocket 用于通知站点，站长在站点的实时活动，包括不限于文章的发布和更新。"}),(0,r.jsx)(u.iz,{}),(0,r.jsxs)("p",{children:["当前 Socket 状态： ",(0,r.jsx)(g,{})]})]})}),g=()=>{let e=(0,o.Qb)();return(0,r.jsxs)("div",{className:"inline-flex items-center",children:[(0,r.jsx)(a.X,{trackerMessage:"socket_status",action:h.b.Impression}),e?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{className:"absolute size-5",style:{background:"radial-gradient(45.91% 45.91% at 49.81% 54.09%, #00FC47 7.13%, rgba(174, 244, 194, 0.46) 65.83%, rgba(252, 252, 252, 0.00) 100%)"}}),(0,r.jsx)("span",{className:"ml-6",children:"已连接"})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{className:"absolute size-5",style:{background:"radial-gradient(45.91% 45.91% at 49.81% 54.09%, #FC0000 7.13%, rgba(244, 174, 174, 0.46) 65.83%, rgba(252, 252, 252, 0.00) 100%)"}}),(0,r.jsx)("span",{className:"ml-6",children:"未连接"})]})]})},b=()=>{let e=(0,p.f)(),t=(0,l.NB)();return e?(0,r.jsxs)("div",{className:"inline-flex items-center gap-2",children:[(0,r.jsx)(d.r,{asChild:!0,placement:"top",trigger:"both",offset:10,triggerElement:(0,r.jsxs)("span",{className:"cursor-pointer",children:["正在被"," ",(0,r.jsx)("span",{children:(0,r.jsx)(m.r,{children:t})})," ","人看爆"]},t),children:(0,r.jsx)(j,{})}),(0,r.jsx)(v,{})]}):null},j=()=>{let{data:e}=(0,i.useQuery)({queryKey:["rooms"],refetchOnMount:!0,staleTime:1e4,queryFn:async()=>{await (0,s._v)(1e3);let e=(await x.x1.activity.getRoomsInfo()).$serialized,t=[],n=e=>"article_".concat(e);return e.objects.notes.forEach(r=>{t.push({path:(0,f.n)(f.Z.Note,{id:r.nid}),title:r.title,count:e.roomCount[n(r.id)]})}),e.objects.posts.forEach(r=>{t.push({path:(0,f.n)(f.Z.Post,{category:r.category.slug,slug:r.slug}),title:r.title,count:e.roomCount[n(r.id)]})}),e.objects.pages.forEach(r=>{t.push({path:(0,f.n)(f.Z.Page,{slug:r.slug}),title:r.title,count:e.roomCount[n(r.id)]})}),t.sort((e,t)=>t.count-e.count)}});return e?0===e.length?(0,r.jsx)("div",{className:"text-gray-500",children:"还没有小伙伴在阅览文章哦~"}):(0,r.jsxs)("div",{className:"max-w-[80vw] lg:max-w-[400px]",children:[(0,r.jsx)("div",{className:"mb-2 text-sm font-medium",children:"下面的内容正在被看爆："}),(0,r.jsx)("ul",{className:"flex flex-col justify-between gap-2",children:e.map(e=>(0,r.jsxs)("li",{className:"flex items-center justify-between",children:[(0,r.jsx)(c.c,{href:e.path,className:"hover:underline",children:e.title}),!!e.count&&(0,r.jsxs)("span",{className:"ml-5 inline-flex items-center text-sm text-gray-500",children:[(0,r.jsx)("i",{className:"icon-[mingcute--user-visible-line]"})," ",e.count]})]},e.path))})]}):(0,r.jsx)("div",{className:"flex size-6 center",children:(0,r.jsx)("div",{className:"loading loading-spinner"})})}},93980:function(e,t,n){"use strict";n.r(t),n.d(t,{OwnerName:function(){return i}});var r=n(13205);let i=()=>(0,r.useAggregationSelector)(e=>e.user.name)},96271:function(e,t,n){"use strict";n.r(t),n.d(t,{VercelPoweredBy:function(){return l}});var r=n(71590),i=n(13205);let s=!!n(69254).env.NEXT_PUBLIC_VERCEL_ENV,l=()=>{let e=(0,i.useAppConfigSelector)(e=>{var t;return(null===(t=e.poweredBy)||void 0===t?void 0:t.vercel)||!1});return s&&e?(0,r.jsx)("img",{src:"https://images.ctfassets.net/e5382hct74si/78Olo8EZRdUlcDUFQvnzG7/fa4cdb6dc04c40fceac194134788a0e2/1618983297-powered-by-vercel.svg",className:"h-10 cursor-pointer object-contain",alt:"Powered by Vercel",tabIndex:0,onClick:()=>{window.open("https://vercel.com/?utm_source=innei&utm_campaign=oss")}}):null}},70334:function(e,t,n){"use strict";n.r(t),n.d(t,{AnimatedLogo:function(){return R}});var r=n(71590),i=n(98823),s=n(63488),l=n(15786),o=n(4711),a=n(97270),c=n(22003),u=n(62719),d=n(27971),m=n(10826),h=n(13205),p=n(31721),x=n(14873),f=n(52810),v=n(18278),g=n(82314),b=n(35987),j=n(57317),y=n(29494),w=n(34601);let N=(0,s.createContext)(null),k="https://fastly.jsdelivr.net/gh/Innei/reporter-assets@main",P=()=>Promise.all([fetch("".concat(k,"/app-icon.json")).then(e=>e.json()),fetch("".concat(k,"/app-desc.json")).then(e=>e.json())]),C=()=>{let e=(0,w.xl)(),{data:t}=(0,i.useQuery)({queryKey:["app-icon","app-desc"],queryFn:P});if(!t||e)return null;let[n,s]=t;return(0,r.jsx)(N.Provider,{value:{appIcon:n,appDescription:s},children:(0,r.jsx)(A,{})})},A=(0,s.memo)(()=>{let{enable:e=!1,endpoint:t="/fn/ps/update"}=(0,h.useAppConfigSelector)(e=>e.module.activity)||{},n=(0,u.XP)(),a=(0,j.f)(),{data:c}=(0,i.useQuery)({queryKey:["activity"],queryFn:async()=>await y.x1.proxy(t).post().then(e=>e).catch(()=>({processName:"",processInfo:void 0,mediaInfo:void 0})),refetchInterval:3e5,refetchOnMount:"always",retry:!1,refetchOnReconnect:!0,refetchOnWindowFocus:"always",enabled:e&&a,meta:{persist:!1}});(0,s.useEffect)(()=>{var e,t,n,r;c&&(c.mediaInfo?(0,x.Px)(c.mediaInfo):(0,x.Px)(null),(0,x.MD)({name:(null===(e=c.processInfo)||void 0===e?void 0:e.name)||c.processName,iconUrl:null===(t=c.processInfo)||void 0===t?void 0:t.iconUrl,iconBase64:null===(n=c.processInfo)||void 0===n?void 0:n.iconBase64,description:null===(r=c.processInfo)||void 0===r?void 0:r.description}))},[c]);let d=(0,h.useAggregationSelector)(e=>e.user.name),{process:m,media:p}=n,w=(0,s.useDeferredValue)(m),k=(null==w?void 0:w.name)||"",P=(null==w?void 0:w.iconBase64)||(null==w?void 0:w.iconUrl),{appDescription:C}=(0,s.useContext)(N),A=(null==w?void 0:w.description)||C[(null==w?void 0:w.name)||""],z=(0,s.useMemo)(()=>({processName:k||"",icon:P}),[P,k]);return(0,r.jsxs)(r.Fragment,{children:[!!p&&(0,r.jsxs)(o.m.div,{className:"absolute inset-y-0 left-0 z-10 flex items-center lg:left-[-30px]",children:[(0,r.jsx)("div",{className:"absolute inset-0 z-[-1] flex center",children:(0,r.jsx)("div",{className:"size-6 rounded-md ring-2 ring-red-500 dark:ring-red-400"})}),(0,r.jsxs)(v.r,{TriggerComponent:M,triggerComponentProps:E,type:"tooltip",strategy:"fixed",children:[d," 正在听 ",p.title," - ",p.artist]})]}),a&&(0,r.jsx)(l.M,{children:k&&(0,r.jsx)(o.m.div,{className:"pointer-events-auto absolute inset-y-0 right-0 z-10 flex items-center overflow-hidden lg:right-[-25px]",initial:{opacity:1e-4,y:15},animate:{opacity:1,x:0,y:0},exit:{opacity:0,x:-10},transition:g.Ew,children:(0,r.jsx)(v.r,{TriggerComponent:M,triggerComponentProps:z,type:"tooltip",strategy:"fixed",children:(0,r.jsx)(f.X,{action:b.b.Impression,trackerMessage:"Activity",children:(0,r.jsxs)("span",{className:"whitespace-pre-line",children:[d," 正在使用 ",k,A?" ".concat(A):""]})})})},k)})]})});A.displayName="Activity";let E={processName:"cmusic"},M=(0,s.memo)(e=>{let{processName:t,icon:n}=e,{appIcon:i}=(0,s.useContext)(N),l=!!i[t],o=!l&&n?n:l?"".concat(k,"/apps/").concat(i[t],".png"):"",a=(0,p.Z)("pointer-events-none select-none",{"rounded-md":!l}),[c,u]=s.useState(!1);return o?(0,r.jsx)("img",{width:32,height:32,src:c?"data:image/png;base64,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":o,alt:t,fetchPriority:"low",className:a,onError:()=>u(!0)}):null});M.displayName="ActivityIcon";var z=n(52282),I=n(29318);let S=e=>{let{className:t}=e,n=(0,h.useAggregationSelector)(e=>e.user.avatar),l=(0,h.useAppConfigSelector)(e=>{var t,n;return null===(n=e.module)||void 0===n?void 0:null===(t=n.bilibili)||void 0===t?void 0:t.liveId}),{data:o}=(0,i.useQuery)({queryKey:["live-check"],queryFn:()=>fetch("/api/bilibili/check_live?liveId=".concat(l),{next:{revalidate:1}}).then(e=>e.json()).catch(()=>null),select:(0,s.useCallback)(e=>!!e,[]),refetchInterval:6e4,enabled:!!l,meta:{persist:!1}});if(n)return(0,r.jsxs)("div",{role:o?"button":"img",className:(0,I.Y2)("overflow pointer-events-none relative z-[9] select-none",o?"cursor-pointer rounded-full":"",t),children:[(0,r.jsx)(z.default,{src:n,alt:"Site Owner Avatar",width:40,height:40,className:(0,I.Y2)("ring-2 ring-slate-200 dark:ring-neutral-800",o?"rounded-full":"mask mask-squircle")}),o&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("p",{className:"absolute bottom-0 right-0 z-[1] rounded-md bg-red-400 p-1 font-[system-ui] text-[6px] text-white dark:bg-orange-700",children:"LIVE"}),(0,r.jsx)("div",{className:"absolute inset-0 scale-100 animate-ping rounded-full ring-2 ring-red-500/80"})]})]})},O=()=>{let e=(0,a.useRouter)(),{data:t}=(0,i.useQuery)({queryKey:["live-check"],enabled:!1}),{liveId:n}=(0,h.useAppConfigSelector)(e=>{var t;return null===(t=e.module)||void 0===t?void 0:t.bilibili})||d.Uk,l=(0,s.useCallback)(()=>{window.open("https://live.bilibili.com/".concat(n))},[n]),o=(0,u.jN)(),p=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:250,[r,i]=(0,s.useState)(0);return(0,s.useEffect)(()=>{let s=setTimeout(()=>{1===r&&e(),i(0)},n);return 2===r&&t(),()=>clearTimeout(s)},[t,e,r]),()=>i(e=>e+1)}(()=>{if(t)return l();e.push(m.Z.Home)},()=>{if((0,c.iH)()){location.href=o();return}e.push("".concat(m.Z.Login,"?redirect=").concat(encodeURIComponent(location.pathname)))});return(0,r.jsxs)("button",{onClick:p,children:[(0,r.jsx)(S,{className:"cursor-pointer"}),(0,r.jsx)("span",{className:"sr-only",children:"Owner Avatar"})]})},R=()=>{let e=(0,w.xl)();return(0,u.Sj)(e=>e.lg&&0!==e.w)?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(O,{}),(0,r.jsx)(C,{})]}):(0,r.jsx)(l.M,{children:!e&&(0,r.jsxs)(o.m.div,{layout:!0,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:[(0,r.jsx)(C,{}),(0,r.jsx)(O,{})]})})}},18310:function(e,t,n){"use strict";n.r(t),n.d(t,{BluredBackground:function(){return l}});var r=n(71590),i=n(31721),s=n(34601);let l=()=>{let e=(0,s.BA)();return(0,r.jsx)("div",{className:(0,i.Z)("absolute inset-0 transform-gpu [-webkit-backdrop-filter:saturate(180%)_blur(20px)] [backdrop-filter:saturate(180%)_blur(20px)] [backface-visibility:hidden]","bg-themed-bg_opacity [border-bottom:1px_solid_rgb(187_187_187_/_20%)]"),style:{opacity:e}})}},24316:function(e,t,n){"use strict";n.d(t,{D:function(){return l}});var r=n(71590),i=n(63488),s=n(31721);let l=(0,i.forwardRef)((e,t)=>{let{children:n,...i}=e;return(0,r.jsx)("button",{className:(0,s.Z)("group size-10 rounded-full bg-gradient-to-b","from-zinc-50/50 to-white/90 px-3 text-sm ring-1 ring-zinc-900/5 backdrop-blur transition dark:from-zinc-900/50 dark:to-zinc-800/90 dark:ring-white/10 dark:hover:ring-white/20","shadow-lg shadow-zinc-800/5","flex center"),...i,ref:t,"aria-label":"Header Action",children:n})});l.displayName="HeaderActionButton"},54401:function(e,t,n){"use strict";n.r(t),n.d(t,{HeaderCenterArea:function(){return u},HeaderLeftButtonArea:function(){return c},HeaderLogoArea:function(){return a}});var r=n(71590),i=n(23235),s=n(29318),l=n(31310),o=n.n(l);let a=e=>{let{children:t}=e;return(0,r.jsx)("div",{className:(0,s.Y2)("relative",o()["header--grid__logo"]),children:(0,r.jsx)("div",{className:(0,s.Y2)("relative flex size-full items-center justify-center"),children:t})})},c=e=>{let{children:t}=e;return(0,r.jsx)("div",{className:(0,s.Y2)("relative flex size-full items-center justify-center lg:hidden"),children:t})},u=e=>{let{children:t}=e;return(0,r.jsx)(i.N,{children:(0,r.jsx)("div",{className:"flex min-w-0 grow",children:(0,r.jsx)("div",{className:"relative flex grow items-center justify-center",children:t})})})}},85569:function(e,t,n){"use strict";n.r(t),n.d(t,{HeaderContent:function(){return P}});var r=n(36637),i=n(71590),s=n(63488),l=n(31721),o=n(99040),a=n(15786),c=n(4711),u=n(70902),d=n(52149),m=n(62291),h=n(97270),p=n(993),x=n(17266),f=n(29318),v=n(98731),g=n(32293),b=n(34601),j=n(18278),y=n(82314);let w=(0,s.memo)(e=>{let{children:t,subMenu:n}=e,r=(0,s.useId)(),l=(0,s.useMemo)(()=>()=>t,[t]);return n?(0,i.jsx)(j.r,{strategy:"fixed",placement:"bottom",offset:10,headless:!0,popoverWrapperClassNames:"z-[19] relative",popoverClassNames:(0,f.Y2)(["select-none rounded-xl bg-white/60 outline-none dark:bg-neutral-900/60","border border-zinc-900/5 shadow-lg shadow-zinc-800/5 backdrop-blur-md","dark:border-zinc-100/10 dark:from-zinc-900/70 dark:to-zinc-800/90","relative flex w-[130px] flex-col py-1","focus-visible:!ring-0"]),TriggerComponent:l,children:!!n.length&&n.map(e=>(0,i.jsx)(N,{currentId:r,...e},e.title))}):t});w.displayName="MenuPopover";let N=(0,s.memo)(function(e){let{title:t,path:n,icon:r,currentId:l}=e,[o,a]=(0,s.useState)(!1);return(0,i.jsxs)(m.default,{href:"".concat(n),className:"relative flex w-full items-center justify-around space-x-2 px-4 py-3 duration-200 hover:text-accent",role:"button",onMouseEnter:()=>{a(!0)},onMouseLeave:()=>{a(!1)},children:[!!r&&(0,i.jsx)("span",{children:r}),(0,i.jsx)("span",{children:t}),o&&(0,i.jsx)(c.m.span,{layoutId:l,transition:y.t0,className:(0,f.Y2)("absolute inset-y-0 left-0 right-2 z-[-1] rounded-md","bg-zinc-50 dark:bg-neutral-900","border border-zinc-200 dark:border-zinc-800")})]},t)});function k(){let e=(0,r._)(["radial-gradient(","px circle at ","px ","px, var(--spotlight-color) 0%, transparent 65%)"]);return k=function(){return e},e}let P=()=>(0,i.jsxs)(o.S,{children:[(0,i.jsx)(A,{children:(0,i.jsx)(E,{})}),(0,i.jsx)(C,{})]}),C=()=>{let e=(0,b.iK)(),t=(0,x.Z)((0,v.ic)(600)&&e,120);return(0,i.jsx)(p.RootPortal,{children:(0,i.jsx)(a.M,{children:t&&(0,i.jsx)(c.m.div,{layout:!0,initial:{y:-20},animate:{y:0},exit:{y:-20,opacity:0},className:"fixed inset-x-0 top-12 z-10 flex justify-center duration-100",children:(0,i.jsx)(E,{})})})})},A=e=>{let{children:t}=e,n=(0,b.bV)(),r=(0,b.iK)();return(0,i.jsx)(c.m.div,{className:"duration-100",style:{opacity:r?n:1,visibility:0===n&&r?"hidden":"visible"},children:s.cloneElement(t,{shouldHideNavBg:!r&&0===n})})},E=e=>{let{className:t,shouldHideNavBg:n,animatedIcon:r=!0}=e,{config:l}=(0,g.useHeaderConfig)(),o=(0,h.usePathname)(),a=(0,u.c)(0),m=(0,u.c)(0),p=(0,u.c)(0),x=s.useCallback(e=>{let{clientX:t,clientY:n,currentTarget:r}=e,i=r.getBoundingClientRect();a.set(t-i.left),m.set(n-i.top),p.set(Math.sqrt(i.width**2+i.height**2)/2.5)},[a,m,p]),v=(0,d.Y)(k(),p,a,m);return(0,i.jsxs)(c.m.nav,{layout:"size",onMouseMove:x,className:(0,f.Y2)("relative","rounded-full bg-gradient-to-b from-zinc-50/70 to-white/90","shadow-lg shadow-zinc-800/5 ring-1 ring-zinc-900/5 backdrop-blur-md","dark:from-zinc-900/70 dark:to-zinc-800/90 dark:ring-zinc-100/10","group [--spotlight-color:oklch(var(--a)_/_0.12)]","duration-200",n&&"!bg-none !shadow-none !ring-transparent",t),children:[(0,i.jsx)(c.m.div,{className:"pointer-events-none absolute -inset-px rounded-full opacity-0 transition-opacity duration-500 group-hover:opacity-100",style:{background:v},"aria-hidden":"true"}),(0,i.jsx)("div",{className:"flex px-4 font-medium text-zinc-800 dark:text-zinc-200",children:l.map(e=>{var t,n,s,l;let a=null!==(l=null===(t=e.subMenu)||void 0===t?void 0:t.findIndex(e=>e.path===o||o.slice(1)===e.path))&&void 0!==l?l:-1;return(0,i.jsx)(M,{iconLayout:r,section:e,subItemActive:null===(n=e.subMenu)||void 0===n?void 0:n[a],isActive:o===e.path||o.startsWith("".concat(e.path,"/"))&&!(null===(s=e.exclude)||void 0===s?void 0:s.includes(o))||a>-1||!1},e.path)})})]})},M=(0,s.memo)(e=>{var t,n;let{section:r,isActive:s,subItemActive:l,iconLayout:o}=e,a=r.path;return(0,i.jsx)(w,{subMenu:r.subMenu,children:(0,i.jsx)(z,{href:a,isActive:s,className:"transition-[padding]",children:(0,i.jsxs)("span",{className:"relative flex items-center",children:[s&&(0,i.jsx)(c.m.span,{layoutId:o?"header-menu-icon":void 0,className:"mr-2 flex items-center",children:null!==(t=null==l?void 0:l.icon)&&void 0!==t?t:r.icon}),(0,i.jsx)(c.m.span,{layout:!0,children:null!==(n=null==l?void 0:l.title)&&void 0!==n?n:r.title})]})})},a)});function z(e){let{href:t,children:n,className:r,isActive:s}=e,o=t.startsWith("http"),a=o?"a":m.default;return(0,i.jsx)("div",{children:(0,i.jsxs)(a,{href:t,className:(0,f.Y2)("relative block whitespace-nowrap px-4 py-2 transition",s?"text-accent":"hover:text-accent/80",s?"active":"",r),target:o?"_blank":void 0,children:[n,s&&(0,i.jsx)(c.m.span,{className:(0,l.Z)("absolute inset-x-1 -bottom-px h-px","bg-gradient-to-r from-accent/0 via-accent/70 to-accent/0"),layoutId:"active-nav-item"})]})})}M.displayName="HeaderMenuItem"},32293:function(e,t,n){"use strict";n.r(t),n.d(t,{HeaderDataConfigureProvider:function(){return d},useHeaderConfig:function(){return u}});var r=n(71590),i=n(63488),s=n(191),l=n(13205),o=n(75832);let a=[{title:"首页",path:"/",type:"Home",icon:(0,i.createElement)(o.RM),subMenu:[]},{title:"文稿",path:"/posts",type:"Post",subMenu:[],icon:(0,i.createElement)(o.$F)},{title:"手记",type:"Note",path:"/notes",icon:(0,i.createElement)(o.ol),exclude:["/notes/topics"]},{title:"时光",icon:(0,i.createElement)(o.EH),path:"/timeline",subMenu:[{title:"生活",icon:(0,i.createElement)(o.ol),path:"/timeline?type=note"},{title:"博文",icon:(0,i.createElement)(o.Dj),path:"/timeline?type=post"},{title:"回忆",icon:(0,i.createElement)(o.kx),path:"/timeline?memory=1"},{title:"专栏",path:"/notes/topics",icon:(0,i.createElement)("i",{className:"icon-[mingcute--align-bottom-fill] flex center"})}]},{title:"友链",icon:(0,i.createElement)(o.WO),path:"/friends"},{title:"更多",icon:(0,i.createElement)(o.j6),path:"#",subMenu:[{title:"思考",icon:(0,i.createElement)(o.iz),path:"/thinking"},{title:"项目",icon:(0,i.createElement)(o.rM),path:"/projects"},{title:"一言",path:"/says",icon:(0,i.createElement)(o.pY)},{title:"跃迁",icon:(0,i.createElement)(o.ak),path:"https://travel.moe/go.html"}]}],c=(0,i.createContext)({config:a}),u=()=>(0,i.useContext)(c),d=e=>{let{children:t}=e,n=(0,l.useAggregationSelector)(e=>e.pageMeta),o=(0,l.useAggregationSelector)(e=>e.categories),[u,d]=(0,i.useState)(a);return(0,i.useEffect)(()=>{if(!n)return;let e=(0,s.Xh)(a);if(n){let t=e.findIndex(e=>"Home"===e.type);if(-1!==t)for(let r of(e[t].subMenu=[],n))e[t].subMenu.push({path:"/".concat(r.slug),title:r.title})}if(null==o?void 0:o.length){let t=e.findIndex(e=>"Post"===e.type);if(-1!==t)for(let n of(e[t].subMenu=[],o))e[t].subMenu.push({path:"/categories/".concat(n.slug),title:n.name})}d(e)},[o,n]),(0,r.jsx)(c.Provider,{value:(0,i.useMemo)(()=>({config:u}),[u]),children:t})}},97317:function(e,t,n){"use strict";n.r(t),n.d(t,{HeaderDrawerButton:function(){return v},drawerOpenAtom:function(){return f}});var r=n(71590),i=n(36183),s=n(16276),l=n(13373),o=n(24316),a=n(63488),c=n(4711),u=n(62291),d=n(82314),m=n(86990),h=n(32293);let p=()=>{let{config:e}=(0,h.useHeaderConfig)();return(0,r.jsx)("div",{className:"mt-12 max-h-screen w-[90vw] space-y-4 overflow-auto pb-24 scrollbar-none",children:e.map((e,t)=>(0,r.jsxs)(c.m.section,{initial:{y:30,opacity:0},animate:{y:0,opacity:1},transition:{...d.y_,delay:.08*t},children:[(0,r.jsx)(x,{className:"block",href:e.path,children:(0,r.jsxs)("span",{className:"flex items-center space-x-2 py-2 text-lg",children:[(0,r.jsx)("i",{children:e.icon}),(0,r.jsx)("h2",{children:e.title})]})}),e.subMenu&&(0,r.jsx)("ul",{className:"my-2 grid grid-cols-2 gap-2",children:e.subMenu.map(e=>(0,r.jsx)("li",{children:(0,r.jsx)(x,{className:"inline-block p-2",href:e.path,children:e.title})},e.path))})]},e.path))})},x=(0,a.memo)(function(e){let{children:t,...n}=e;return(0,r.jsx)(u.default,{...n,prefetch:!1,onClick:()=>{m.e.set(f,!1)},children:t})}),f=(0,i.atom)(!1),v=()=>{let e=(0,l.O)(),t=(0,r.jsx)(o.D,{children:(0,r.jsx)("i",{className:"icon-[mingcute--menu-line]"})});return e?(0,r.jsx)(s.d,{content:(0,r.jsx)(p,{}),children:t}):t}},48457:function(e,t,n){"use strict";n.r(t),n.d(t,{HeaderMeta:function(){return u}});var r=n(71590),i=n(15786),s=n(4711),l=n(82314),o=n(13205),a=n(34601);let c={initial:{opacity:0,y:20},exit:{opacity:0,y:20},animate:{opacity:1,y:0,transition:{...l.Q0}}},u=()=>{let e=(0,a.xl)(),{description:t,title:n,slug:l}=(0,a.Ij)(),u=(0,o.useAggregationSelector)(e=>e.seo.title);return(0,r.jsx)(i.M,{children:e&&(0,r.jsxs)(s.m.div,{className:"absolute inset-0 flex min-w-0 items-center justify-between px-0 lg:px-16","data-testid":"header-meta",...c,children:[(0,r.jsxs)("div",{className:"align-center flex min-w-0 shrink grow flex-col",children:[(0,r.jsx)("small",{className:"min-w-0 truncate",children:(0,r.jsx)("span",{className:"text-gray-600/60 dark:text-gray-300/60",children:t})}),(0,r.jsx)("h2",{className:"min-w-0 truncate text-[1.2rem] font-medium leading-normal",children:n})]}),(0,r.jsxs)("div",{className:"hidden min-w-0 shrink flex-col text-right leading-5 lg:flex",children:[(0,r.jsxs)("small",{className:"min-w-0 truncate whitespace-pre text-gray-600/60 dark:text-gray-300/60",children:[" ",l]}),(0,r.jsx)("span",{className:"font-medium text-gray-600 dark:text-gray-300",children:u})]})]})})}},66736:function(e,t,n){"use strict";n.r(t),n.d(t,{HeaderWithShadow:function(){return o}});var r=n(71590),i=n(31721),s=n(34601),l=n(98731);let o=e=>{let{children:t}=e,n=(0,s.BA)(),o=(0,l.nZ)(e=>e>100&&n>.8,[n]);return(0,r.jsx)("header",{"data-hide-print":!0,className:(0,i.Z)("fixed inset-x-0 top-0 z-[9] h-[4.5rem] overflow-hidden transition-shadow duration-200 lg:ml-[calc(100vw-100%)]",o&&"shadow-none shadow-neutral-100 dark:shadow-neutral-800/50 lg:shadow-sm"),children:t})}},47794:function(e,t,n){"use strict";n.r(t),n.d(t,{UserAuth:function(){return y}});var r=n(71590);n(63488);var i=n(15786),s=n(27422),l=n(52282),o=n(97270),a=n(62719),c=n(2226),u=n(58704),d=n(18278),m=n(4348),h=n(13205),p=n(24316);let x=(0,s.default)(()=>n.e(3838).then(n.bind(n,3838)).then(e=>e.SignedIn),{loadableGenerated:{webpack:()=>[null]}}),f=(0,s.default)(()=>n.e(8329).then(n.bind(n,8329)).then(e=>e.UserAuthFromIcon),{loadableGenerated:{webpack:()=>[8329]}}),v=(0,s.default)(()=>n.e(3838).then(n.bind(n,3838)).then(e=>e.SignedOut),{loadableGenerated:{webpack:()=>[null]}}),g=(0,s.default)(()=>n.e(3838).then(n.bind(n,3838)).then(e=>e.UserButton),{loadableGenerated:{webpack:()=>[null]}}),b=(0,s.default)(()=>n.e(3838).then(n.bind(n,3838)).then(e=>e.SignInButton),{loadableGenerated:{webpack:()=>[null]}}),j=()=>{let e=(0,h.useAggregationSelector)(e=>e.user.avatar);return(0,r.jsxs)(u.EM,{onClick:()=>{window.open("/dashboard","_blank")},className:"pointer-events-auto relative flex items-center justify-center",children:[(0,r.jsx)("span",{className:"sr-only",children:"Go to dashboard"}),(0,r.jsx)(l.default,{className:"rounded-full",height:36,width:36,src:e,alt:"site owner"}),(0,r.jsx)(f,{className:"absolute -bottom-1 -right-1"})]})};function y(){let e=(0,o.usePathname)();return(0,a.DH)()?(0,r.jsx)(j,{}):(0,r.jsxs)(i.M,{children:[(0,r.jsx)(x,{children:(0,r.jsx)("div",{className:"pointer-events-auto flex h-10 w-full items-center justify-center",children:(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(g,{afterSignOutUrl:(0,m.Y4)(e).href,appearance:{elements:{logoBox:"w-9 h-9 ring-2 ring-white/20 rounded-full"}}}),(0,r.jsx)(f,{className:"absolute -bottom-1 -right-1"})]})})},"user-info"),(0,r.jsx)(v,{children:(0,r.jsx)(d.r,{TriggerComponent:w,wrapperClassName:"h-full w-full flex items-center justify-center",type:"tooltip",children:"登录"})},"sign-in")]})}let w=()=>{let e=(0,o.usePathname)();return(0,r.jsx)(b,{mode:"modal",redirectUrl:(0,m.Y4)(e).href,children:(0,r.jsx)(p.D,{"aria-label":"Guest Login",children:(0,r.jsx)(c.V,{className:"size-4"})})})}},34601:function(e,t,n){"use strict";n.d(t,{BA:function(){return f},Ij:function(){return j},bV:function(){return p},dK:function(){return h},iK:function(){return w},n2:function(){return b},xl:function(){return g}});var r=n(63488),i=n(36183),s=n(62719),l=n(86990),o=n(98731);let a=(0,i.atom)(""),c=(0,i.atom)(""),u=(0,i.atom)(""),d=(0,i.atom)(!0),m=()=>(0,i.useAtomValue)(d),h=()=>(0,i.useSetAtom)(d),p=()=>1-f(),x=()=>p()>0,f=()=>{let e=(0,s.dD)(),t=m()||e;return(0,o.nZ)(e=>t?e>=50?1:Math.floor(e/50*100)/100:0,[t])},v=(0,i.atom)(e=>{let t=e(a),n=e(c);return""!==t&&""!==n}),g=()=>{let e=x();return(0,i.useAtomValue)(v)&&!e},b=()=>((0,r.useEffect)(()=>()=>{l.e.set(a,""),l.e.set(c,""),l.e.set(u,"")},[]),e=>{let{title:t,description:n,slug:r}=e;l.e.set(a,t),l.e.set(c,n),r&&l.e.set(u,r)}),j=()=>({title:(0,i.useAtomValue)(a),description:(0,i.useAtomValue)(c),slug:(0,i.useAtomValue)(u)}),y=(0,i.atom)(e=>{let t=e(a),n=e(c);return""!==t&&""!==n}),w=()=>(0,i.useAtomValue)(y)},86940:function(e,t,n){"use strict";n.d(t,{c:function(){return u}});var r=n(71590),i=n(63488),s=n(62291),l=n(97270),o=n(98177),a=n(10826),c=n(13107);let u=e=>{let{href:t,children:n,...u}=e,d=(0,c.j)(),m=(0,l.usePathname)(),h=(0,i.useCallback)(async e=>{"/"!==m&&m!==a.Z.Posts&&d(t)&&(0,o.PF)(e)},[t,m,d]);return(0,r.jsx)(s.default,{href:t,onClick:h,...u,children:n})}},13107:function(e,t,n){"use strict";n.d(t,{j:function(){return h}});var r=n(71590),i=n(63488),s=n(62719),l=n(96859),o=n(4711),a=n(62291),c=n(52810),u=n(82314),d=n(35987);let m=e=>{let{dismissAll:t,dismissTop:n}=(0,l.Vu)();return(0,r.jsxs)("div",{className:"relative mx-auto mt-[10vh] max-w-full overflow-auto px-2 scrollbar-none lg:max-w-[65rem] lg:p-0",children:[(0,r.jsx)(c.X,{action:d.b.Impression,trackerMessage:"Peek Modal"}),(0,r.jsx)(o.m.div,{initial:{opacity:.5,y:50},animate:{opacity:1,y:0},exit:{opacity:0,y:50},transition:u.Q0,className:"scrollbar-none",children:e.children}),(0,r.jsxs)(o.m.div,{initial:!0,exit:{opacity:0},className:"fixed right-2 top-2 flex items-center gap-4",children:[(0,r.jsxs)(a.default,{className:"flex size-8 rounded-full p-1 shadow-sm ring-1 ring-zinc-200 center dark:ring-neutral-800",href:e.to,onClick:t,children:[(0,r.jsx)("i",{className:"icon-[mingcute--fullscreen-2-line] text-lg"}),(0,r.jsx)("span",{className:"sr-only",children:"Go to this link"})]}),(0,r.jsxs)("button",{className:"flex size-8 rounded-full p-1 shadow-sm ring-1 ring-zinc-200 center dark:ring-neutral-800",onClick:n,children:[(0,r.jsx)("i",{className:"icon-[mingcute--close-line] text-lg"}),(0,r.jsx)("span",{className:"sr-only",children:"Dimiss"})]})]})]})},h=()=>{let e=(0,s.dD)(),{present:t}=(0,l.Vu)();return(0,i.useCallback)(i=>{if(e)return;let s={clickOutsideToDismiss:!0,title:"Preview",modalClassName:"relative mx-auto mt-[10vh] scrollbar-none max-w-full overflow-auto px-2 lg:max-w-[65rem] lg:p-0"};return i.startsWith("/notes/")?(requestAnimationFrame(async()=>{let e=await Promise.all([n.e(8843),n.e(2282),n.e(6370),n.e(9914),n.e(1418),n.e(9929),n.e(3838),n.e(9315),n.e(9430),n.e(775),n.e(6117),n.e(3774),n.e(9798),n.e(7628),n.e(8078)]).then(n.bind(n,29334)).then(e=>e.NotePreview);t({...s,CustomModalComponent:()=>(0,r.jsx)(m,{to:i,children:(0,r.jsx)(e,{noteId:parseInt(i.split("/").pop())})}),content:()=>null})}),!0):!!i.startsWith("/posts/")&&(requestAnimationFrame(async()=>{let e=await Promise.all([n.e(8843),n.e(2282),n.e(6370),n.e(9914),n.e(1418),n.e(9929),n.e(3838),n.e(9315),n.e(9289),n.e(775),n.e(6117),n.e(3774),n.e(9798),n.e(5221),n.e(1205)]).then(n.bind(n,12343)).then(e=>e.PostPreview),l=i.split("/"),o=l.pop(),a=l.pop();t({...s,CustomModalComponent:()=>(0,r.jsx)(m,{to:i,children:(0,r.jsx)(e,{category:a,slug:o})}),content:()=>null})}),!0)},[e,t])}},82629:function(e,t,n){"use strict";n.d(t,{p:function(){return f}});var r=n(71590),i=n(63488),s=n(58704),l=n(31942),o=n(13238),a=n(98177),c=n(29494),u=n(58168),d=n(13205),m=n(76767);let h={post_c:"文章",note_c:"手记",say_c:"说说",recently_c:"速记"},p={email:"",types:{post_c:!1,note_c:!1,say_c:!1,recently_c:!1}},x=()=>{let[e,t]=(0,i.useReducer)((e,t)=>{switch(t.type){case"set":return{...e,...t.data};case"reset":return p}},{...p});return[e,t]},f=e=>{let{onConfirm:t,defaultTypes:n}=e,[p,f]=x(),v=(0,m.Lr)(),g=(0,o.h)(p);(0,i.useEffect)(()=>{n&&n.length&&f({type:"set",data:{types:n.reduce((e,t)=>(e[t]=!0,e),{...g.current.types})}})},[]);let b=(0,m.bY)(),j=async e=>{if(!v){u.A.error("订阅功能暂时没有开启哦");return}(0,a.PF)(e);let{email:n,types:r}=p;await c.x1.subscribe.subscribe(n,Object.keys(r).filter(e=>p.types[e])),u.A.success("订阅成功，谢谢你！"),f({type:"reset"}),t()},y=(0,d.useAggregationSelector)(e=>e.seo.title);return(0,r.jsxs)("form",{onSubmit:j,className:"flex flex-col gap-5",children:[(0,r.jsxs)("p",{className:"text-gray-1 text-sm",children:["欢迎订阅「",y,"」，我会定期推送最新的内容到你的邮箱。"]}),(0,r.jsx)(l.I,{type:"text",placeholder:"留下你的邮箱哦 *",required:!0,value:p.email,onChange:e=>{f({type:"set",data:{email:e.target.value}})}}),(0,r.jsx)("div",{className:"mb-2 flex gap-10",children:Object.keys(p.types).filter(e=>{var t;return null===(t=b.data)||void 0===t?void 0:t.allowTypes.includes(e)}).map(e=>(0,r.jsxs)("fieldset",{className:"children:cursor-pointer inline-flex items-center text-sm",children:[(0,r.jsx)("input",{className:"checkbox-accent checkbox checkbox-sm mr-2",type:"checkbox",onChange:t=>{f({type:"set",data:{types:{...p.types,[e]:t.target.checked}}})},checked:p.types[e],id:e}),(0,r.jsx)("label",{htmlFor:e,className:"text-shizuku",children:h[e]})]},e))}),(0,r.jsxs)("p",{className:"text-gray-1 -mt-2 text-sm",children:["或者你也可以通过"," ",(0,r.jsx)("a",{href:"/feed",className:"text-green",target:"_blank",children:"/feed"})," ","订阅「",y,"」的 RSS 流。"]}),(0,r.jsx)(s.Sn,{disabled:!p.email,children:"订阅"})]})}},55235:function(e,t,n){"use strict";n.r(t),n.d(t,{SubscribeTextButton:function(){return s}});var r=n(71590),i=n(76767);let s=e=>{let{children:t}=e,n=(0,i.Lr)(),{present:s}=(0,i.kk)();return n?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{children:(0,r.jsx)("button",{onClick:s,children:"订阅"})}),t]}):null}},76767:function(e,t,n){"use strict";n.d(t,{Lr:function(){return u},bY:function(){return c},kk:function(){return d}});var r=n(71590),i=n(98823),s=n(96859),l=n(29494),o=n(82629);let a=["subscribe-status"],c=()=>(0,i.useQuery)({queryKey:a,queryFn:l.x1.subscribe.check,gcTime:6e5}),u=()=>(0,i.useQuery)({queryKey:a,queryFn:l.x1.subscribe.check,select:e=>null==e?void 0:e.enable,gcTime:6e5,staleTime:6e5,meta:{persist:!1}}),d=e=>{let{present:t}=(0,s.Vu)();return{present:()=>{let n=t({title:"邮件订阅",clickOutsideToDismiss:!0,content:()=>(0,r.jsx)(o.p,{onConfirm:n,defaultTypes:e})})}}}},30465:function(e,t,n){"use strict";n.r(t),n.d(t,{TocAutoScroll:function(){return s}});var r=n(63488),i=n(98177);let s=()=>((0,r.useEffect)(()=>{let e=(0,i.KN)(decodeURIComponent(window.location.hash.slice(1)));if(e){let t=document.getElementById(e);t&&t.scrollIntoView({behavior:"smooth",block:"center"})}},[]),null)},31942:function(e,t,n){"use strict";n.d(t,{I:function(){return o}});var r=n(71590),i=n(63488),s=n(11269),l=n(29318);let o=(0,i.forwardRef)((e,t)=>{let{className:n,...i}=e,o=(0,s.v)(i);return(0,r.jsx)("input",{ref:t,className:(0,l.Y2)("min-w-0 flex-auto appearance-none rounded-lg border ring-accent/20 duration-200 sm:text-sm","bg-base-100 px-3 py-[calc(theme(spacing.2)-1px)] placeholder:text-zinc-400 focus:outline-none focus:ring-2","border-zinc-900/10 dark:border-zinc-700","focus:border-accent/80 dark:bg-zinc-700/[0.15] dark:text-zinc-200 dark:placeholder:text-zinc-500","password"===i.type?"font-mono":"font-[system-ui]",n),...i,...o})});o.displayName="Input"},46403:function(e,t,n){"use strict";n.d(t,{r:function(){return a}});var r=n(71590),i=n(15786),s=n(4711),l=n(82314),o=n(17266);let a=e=>{let{children:t}=e,n=(0,o.Z)(t,300);return(0,r.jsx)(i.M,{mode:"popLayout",initial:!1,children:(0,r.jsx)(s.m.span,{initial:{opacity:0,y:-16},animate:{opacity:1,y:0},exit:{opacity:0,y:-16,position:"absolute"},transition:l.$O,children:n},n)})}},60228:function(e,t,n){"use strict";n.r(t),n.d(t,{ThemeSwitcher:function(){return p}});var r=n(71590),i=n(17664),s=n(12887),l=n(51789),o=n(13373),a=n(98177);let c=(0,l.tv)({base:"rounded-inherit inline-flex h-[32px] w-[32px] items-center justify-center border-0 text-current",variants:{status:{active:""}}}),u="h-4 w-4 text-current",d=()=>(0,r.jsxs)("svg",{className:u,fill:"none",height:"24",shapeRendering:"geometricPrecision",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",viewBox:"0 0 24 24",width:"24",children:[(0,r.jsx)("circle",{cx:"12",cy:"12",r:"5"}),(0,r.jsx)("path",{d:"M12 1v2"}),(0,r.jsx)("path",{d:"M12 21v2"}),(0,r.jsx)("path",{d:"M4.22 4.22l1.42 1.42"}),(0,r.jsx)("path",{d:"M18.36 18.36l1.42 1.42"}),(0,r.jsx)("path",{d:"M1 12h2"}),(0,r.jsx)("path",{d:"M21 12h2"}),(0,r.jsx)("path",{d:"M4.22 19.78l1.42-1.42"}),(0,r.jsx)("path",{d:"M18.36 5.64l1.42-1.42"})]}),m=()=>(0,r.jsxs)("svg",{className:u,fill:"none",height:"24",shapeRendering:"geometricPrecision",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",viewBox:"0 0 24 24",width:"24",children:[(0,r.jsx)("rect",{x:"2",y:"3",width:"20",height:"14",rx:"2",ry:"2"}),(0,r.jsx)("path",{d:"M8 21h8"}),(0,r.jsx)("path",{d:"M12 17v4"})]}),h=()=>(0,r.jsx)("svg",{fill:"none",height:"24",shapeRendering:"geometricPrecision",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",viewBox:"0 0 24 24",width:"24",className:u,children:(0,r.jsx)("path",{d:"M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"})}),p=()=>(0,r.jsxs)("div",{className:"relative inline-block",children:[(0,r.jsx)(x,{}),(0,r.jsx)(f,{})]}),x=()=>{let{theme:e}=(0,s.F)();return(0,o.O)()&&e?(0,r.jsx)("div",{className:"absolute top-[4px] z-[-1] size-[32px] rounded-full bg-base-100 shadow-[0_1px_2px_0_rgba(127.5,127.5,127.5,.2),_0_1px_3px_0_rgba(127.5,127.5,127.5,.1)] duration-200",style:{left:{light:4,system:36,dark:68}[e]}}):null},f=()=>{let{setTheme:e}=(0,s.F)(),t=t=>{(0,a.sj)(()=>{(0,i.flushSync)(()=>e(t))})};return(0,r.jsxs)("div",{className:"w-fit-content inline-flex rounded-full border border-zinc-200 p-[3px] dark:border-zinc-700",children:[(0,r.jsx)("button",{"aria-label":"Switch to light theme",type:"button",className:c.base,onClick:()=>{t("light")},children:(0,r.jsx)(d,{})}),(0,r.jsx)("button",{"aria-label":"Switch to system theme",className:c.base,type:"button",onClick:()=>{t("system")},children:(0,r.jsx)(m,{})}),(0,r.jsx)("button",{"aria-label":"Switch to dark theme",className:c.base,type:"button",onClick:()=>{t("dark")},children:(0,r.jsx)(h,{})})]})}},66579:function(e,t,n){"use strict";n.r(t),n.d(t,{OnlyDesktop:function(){return a}});var r=n(36183),i=n(35588),s=n(8057),l=n(13373);let o=e=>e.lg&&0!==e.w,a=e=>{let{children:t}=e,n=(0,l.O)(),a=(0,r.useAtomValue)((0,i.selectAtom)(s.q,o));return n&&a?t:null}},61962:function(e,t,n){"use strict";n.r(t),n.d(t,{OnlyMobile:function(){return s}});var r=n(62719),i=n(13373);let s=e=>{let{children:t}=e,n=(0,i.O)(),s=(0,r.dD)();return n&&s?t:null}},23235:function(e,t,n){"use strict";n.d(t,{N:function(){return r.OnlyDesktop}});var r=n(66579)},11269:function(e,t,n){"use strict";n.d(t,{v:function(){return i}});var r=n(63488);let i=e=>{let{onKeyDown:t,onCompositionStart:n,onCompositionEnd:i}=e,s=(0,r.useRef)(!1),l=(0,r.useCallback)(e=>{s.current=!0,null==n||n(e)},[n]);return{onCompositionEnd:(0,r.useCallback)(e=>{s.current=!1,null==i||i(e)},[i]),onCompositionStart:l,onKeyDown:(0,r.useCallback)(e=>{if(null==t||t(e),s.current){e.stopPropagation();return}},[t])}}},13238:function(e,t,n){"use strict";n.d(t,{h:function(){return i}});var r=n(63488);let i=e=>{let t=(0,r.useRef)(e);return(0,r.useEffect)(()=>{t.current=e},[e]),t}},4348:function(e,t,n){"use strict";n.d(t,{J8:function(){return l},M4:function(){return a},P1:function(){return o},Y4:function(){return s}});var r=n(76877),i=n(13205);function s(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return r.r8?new URL(t,"http://localhost:2323"):new URL(t,null===(e=(0,i.getAggregationData)())||void 0===e?void 0:e.url.webUrl)}function l(e){return c(e.title)&&c(e.slug)&&!c(e.order)}function o(e){return c(e.title)&&c(e.slug)&&c(e.order)}function a(e){return c(e.title)&&c(e.nid)}function c(e){return null!=e}s.build=function(e){return l(e)?e.category?"/posts/".concat(e.category.slug,"/").concat(encodeURIComponent(e.slug)):(console.error("PostModel.category is missing!!!!!"),"#"):o(e)?"/".concat(e.slug):a(e)?"/notes/".concat(e.nid):"/"}},13569:function(e,t,n){"use strict";n.r(t),n.d(t,{AppFeatureProvider:function(){return l},useFeatureEnabled:function(){return o}});var r=n(71590),i=n(82798);let s=(0,i.kr)({tmdb:!1}),l=e=>{let{children:t,...n}=e;return(0,r.jsx)(s.Provider,{value:n,children:t})},o=e=>(0,i.Sz)(s,t=>t[e])},31310:function(e){e.exports={"header--grid":"grid_header--grid__kaumQ","header--grid__logo":"grid_header--grid__logo__S9trn"}}},function(e){e.O(0,[3595,9805,3623,5874,5322,8030,2636,54,8843,2356,7996,2282,6370,7918,9315,6274,6e3,5737,5268,5881,775,9243,3855,759,9013,1744],function(){return e(e.s=37063)}),_N_E=e.O()}]);